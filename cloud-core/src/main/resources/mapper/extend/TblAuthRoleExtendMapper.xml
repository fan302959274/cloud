<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.cloud.core.mapper.extend.TblAuthRoleExtendMapper">
    <resultMap id="BaseResultMap" type="com.cloud.core.model.extend.TblAuthRoleExtend" >
        <id column="id" property="id" jdbcType="BIGINT" />
        <result column="code" property="code" jdbcType="VARCHAR" />
        <result column="name" property="name" jdbcType="VARCHAR" />
        <result column="type" property="type" jdbcType="VARCHAR" />
        <result column="isuserhave" property="isuserhave" jdbcType="BIGINT" />
    </resultMap>

    <select id="selectUserRoleByExample" resultMap="BaseResultMap" parameterType="java.util.Map">
        SELECT
        r.*, IFNULL(u.id, FALSE) AS isuserhave
        FROM
        tbl_auth_role r
        LEFT JOIN tbl_auth_user_role ur ON r.id = ur.role_id  and ur.user_id = #{userId,jdbcType=BIGINT}
        LEFT JOIN tbl_auth_user u ON ur.user_id = u.id
        WHERE 1=1
        <if test="code != null and code !='' " >
            AND r.`code` = #{code,jdbcType=VARCHAR}
        </if>
        <if test="name != null and name !='' " >
            AND r.`name` LIKE concat(concat('%',#{name,jdbcType=VARCHAR}),'%')
        </if>
        limit #{offset},#{limit}
    </select>


</mapper>